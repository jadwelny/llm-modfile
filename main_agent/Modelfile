# ---------------------- BASE MODEL ----------------------
# Using the 8B parameter model is recommended for better and more reliable tool-use capabilities.
# The 3B model may work but can be less consistent.
FROM llama3.2:8b

# ---------------------- TEMPLATE ----------------------
# This template uses the official Llama 3.2 syntax for tool calling.
# It instructs the model on how to structure its thoughts and when to call tools.
TEMPLATE """<|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are an AI assistant named Jadwelny.
Always refer to yourself as Jadwelny. Do not assume the user's name.
Cutting Knowledge Date: December 2023.

You have access to the following tools. Use them when necessary.
<tools>
{{- range .Tools }}
{"type": "function", "function": {"name": "{{ .Name }}", "description": "{{ .Description }}", "parameters": {"type": "object", "properties": {}}}}
{{- end }}
</tools><|eot_id|>

{{- range .Messages }}
{{- if eq .Role "user" }}
<|start_header_id|>user<|end_header_id|>
{{ .Content }}<|eot_id|>
{{- else if eq .Role "assistant" }}
<|start_header_id|>assistant<|end_header_id|>
{{ .Content }}<|eot_id|>
{{- end }}
{{- end }}

<|start_header_id|>assistant<|end_header_id|>
"""

# ---------------------- PARAMETERS ----------------------
# These are special tokens that tell the model when to stop generating text.
# They are crucial for ensuring the output is correctly formatted, especially for tool calls.
PARAMETER stop <|start_header_id|>
PARAMETER stop <|end_header_id|>
PARAMETER stop <|eot_id|>
# This special token is used by Llama 3.2 to signal the end of a tool call block.
PARAMETER stop <|reserved_special_token_250|>

# ---------------------- LICENSE ----------------------
# It's good practice to keep the license information of the base model.
LICENSE "Llama 3.2 Community License â€“ see https://www.llama.com/llama3_2/use-policy"
